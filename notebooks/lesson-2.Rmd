---
title: "Lesson 2"
author: "A Irwin"
date: "2023-05-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse, quietly = TRUE)
library(readxl)
# Before installing brms do this:
# remotes::install_github("coatless-mac/macrtools")
# if internet connection is slow, may need to use Sys.setenv(R_INSTALL_PACKAGES_ELAPSED_TIMEOUT = "5m")
library(brms)
```

## Temperature response curves

Read data from Boyd et al and Liang et al. Plot growth rates.

```{r}
growth_temperature <- read_excel(here::here("data/temperature-growth-rate.xlsx"))
growth_temperature |> 
  ggplot(aes(temperature_C, growth_rate_d)) +
  facet_wrap(~strain) + 
  geom_point() + 
  theme_bw()
```


Fit the temperature response curve.

```{r}
prior1 <- prior(normal(1, 2), nlpar = "a") +
  prior(normal(0, 2), nlpar = "b") +
  prior(normal(0, 2), nlpar = "z") + 
  prior(normal(0, 2), nlpar = "w")
fit1 <- brm(bf(growth_rate_d ~ a * exp(b * temperature_C)*(1-((temperature_C - z)/(w/2))^2), 
               a + b + z + w ~ 1,
               nl = TRUE),
            data = growth_temperature, 
            prior = prior1)

```
